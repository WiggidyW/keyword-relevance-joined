{
  "type": "scalar.function",
  "description": "Keyword-based Relevance Scoring. Discover how relevant a piece of content is to specific keywords. Joins each keyword and executes a single Vector Completion Task.",
  "input_schema": {
    "type": "object",
    "properties": {
      "keywords": {
        "type": "array",
        "description": "Keywords to evaluate relevance against.",
        "minItems": 1,
        "items": {
          "type": "string",
          "description": "A keyword to evaluate relevance against."
        }
      },
      "content": {
        "anyOf": [
          {
            "type": "string",
            "description": "Text content to be evaluated for relevance."
          },
          {
            "type": "image",
            "description": "Image content to be evaluated for relevance."
          },
          {
            "type": "video",
            "description": "Video content to be evaluated for relevance."
          },
          {
            "type": "audio",
            "description": "Audio content to be evaluated for relevance."
          },
          {
            "type": "file",
            "description": "File content to be evaluated for relevance."
          },
          {
            "type": "array",
            "description": "Array of content pieces to be evaluated for relevance.",
            "minItems": 1,
            "items": {
              "anyOf": [
                {
                  "type": "string",
                  "description": "Text content to be evaluated for relevance."
                },
                {
                  "type": "image",
                  "description": "Image content to be evaluated for relevance."
                },
                {
                  "type": "video",
                  "description": "Video content to be evaluated for relevance."
                },
                {
                  "type": "audio",
                  "description": "Audio content to be evaluated for relevance."
                },
                {
                  "type": "file",
                  "description": "File content to be evaluated for relevance."
                }
              ]
            }
          }
        ]
      }
    },
    "required": ["keywords", "content"]
  },
  "tasks": [
    {
      "type": "vector.completion",
      "messages": [
        {
          "role": "user",
          "content": [
            {
              "type": "text",
              "text": {
                "$jmespath": "join('',['How relevant is the following content with regards to:\n- ',join('\n- ',input.keywords),'\n\n\"'])"
              }
            },
            {
              "$jmespath": "input_value_switch(input.content,`null`,&[].input_value_switch(@,`null`,`null`,&{type:'text',text:@},`null`,`null`,`null`,@,@,@,@),&{type:'text',text:@},`null`,`null`,`null`,input.content,input.content,input.content,input.content)"
            },
            {
              "type": "text",
              "text": "\""
            }
          ]
        }
      ],
      "responses": ["Extremely Relevant", "Somewhat Relevant", "Not Relevant"]
    }
  ],
  "output": {
    "$jmespath": "add(tasks[0].scores[0],multiply(tasks[0].scores[1],`0.5`))"
  }
}
